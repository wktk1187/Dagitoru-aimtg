/* esm.sh - @supabase/supabase-js@2.49.4 */
import{FunctionsClient as D}from"/@supabase/functions-js@2.4.4/denonext/functions-js.mjs";import{PostgrestClient as I}from"/@supabase/postgrest-js@1.19.4/denonext/postgrest-js.mjs";import{RealtimeClient as j}from"/@supabase/realtime-js@2.11.2/denonext/realtime-js.mjs";import{StorageClient as N}from"/@supabase/storage-js@2.7.1/denonext/storage-js.mjs";var m="2.49.4";var d="";typeof Deno<"u"?d="deno":typeof document<"u"?d="web":typeof navigator<"u"&&navigator.product==="ReactNative"?d="react-native":d="node";var E={"X-Client-Info":`supabase-js-${d}/${m}`},x={headers:E},_={schema:"public"},T={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},g={};import S,{Headers as y}from"/@supabase/node-fetch@2.6.15/denonext/node-fetch.mjs";var w=function(a,e,t,n){function h(i){return i instanceof t?i:new t(function(r){r(i)})}return new(t||(t=Promise))(function(i,r){function c(s){try{o(n.next(s))}catch(u){r(u)}}function l(s){try{o(n.throw(s))}catch(u){r(u)}}function o(s){s.done?i(s.value):h(s.value).then(c,l)}o((n=n.apply(a,e||[])).next())})},U=a=>{let e;return a?e=a:typeof fetch>"u"?e=S:e=fetch,(...t)=>e(...t)},k=()=>typeof Headers>"u"?y:Headers,O=(a,e,t)=>{let n=U(t),h=k();return(i,r)=>w(void 0,void 0,void 0,function*(){var c;let l=(c=yield e())!==null&&c!==void 0?c:a,o=new h(r?.headers);return o.has("apikey")||o.set("apikey",a),o.has("Authorization")||o.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},r),{headers:o}))})};var C=function(a,e,t,n){function h(i){return i instanceof t?i:new t(function(r){r(i)})}return new(t||(t=Promise))(function(i,r){function c(s){try{o(n.next(s))}catch(u){r(u)}}function l(s){try{o(n.throw(s))}catch(u){r(u)}}function o(s){s.done?i(s.value):h(s.value).then(c,l)}o((n=n.apply(a,e||[])).next())})};function b(a){return a.replace(/\/$/,"")}function A(a,e){let{db:t,auth:n,realtime:h,global:i}=a,{db:r,auth:c,realtime:l,global:o}=e,s={db:Object.assign(Object.assign({},r),t),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},l),h),global:Object.assign(Object.assign({},o),i),accessToken:()=>C(this,void 0,void 0,function*(){return""})};return a.accessToken?s.accessToken=a.accessToken:delete s.accessToken,s}import{AuthClient as F}from"/@supabase/auth-js@2.69.1/denonext/auth-js.mjs";var p=class extends F{constructor(e){super(e)}};var L=function(a,e,t,n){function h(i){return i instanceof t?i:new t(function(r){r(i)})}return new(t||(t=Promise))(function(i,r){function c(s){try{o(n.next(s))}catch(u){r(u)}}function l(s){try{o(n.throw(s))}catch(u){r(u)}}function o(s){s.done?i(s.value):h(s.value).then(c,l)}o((n=n.apply(a,e||[])).next())})},f=class{constructor(e,t,n){var h,i,r;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");let c=b(e);this.realtimeUrl=`${c}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${c}/auth/v1`,this.storageUrl=`${c}/storage/v1`,this.functionsUrl=`${c}/functions/v1`;let l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,o={db:_,realtime:g,auth:Object.assign(Object.assign({},T),{storageKey:l}),global:x},s=A(n??{},o);this.storageKey=(h=s.auth.storageKey)!==null&&h!==void 0?h:"",this.headers=(i=s.global.headers)!==null&&i!==void 0?i:{},s.accessToken?(this.accessToken=s.accessToken,this.auth=new Proxy({},{get:(u,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((r=s.auth)!==null&&r!==void 0?r:{},this.headers,s.global.fetch),this.fetch=O(t,this._getAccessToken.bind(this),s.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},s.realtime)),this.rest=new I(`${c}/rest/v1`,{headers:this.headers,schema:s.db.schema,fetch:this.fetch}),s.accessToken||this._listenForAuthEvents()}get functions(){return new D(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new N(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return L(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:h,storageKey:i,flowType:r,lock:c,debug:l},o,s){let u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new p({url:this.authUrl,headers:Object.assign(Object.assign({},u),o),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:h,flowType:r,lock:c,debug:l,fetch:s,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new j(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};export*from"/@supabase/auth-js@2.69.1/denonext/auth-js.mjs";import{PostgrestError as re}from"/@supabase/postgrest-js@1.19.4/denonext/postgrest-js.mjs";import{FunctionsHttpError as ae,FunctionsFetchError as ce,FunctionsRelayError as he,FunctionsError as ue,FunctionRegion as le}from"/@supabase/functions-js@2.4.4/denonext/functions-js.mjs";export*from"/@supabase/realtime-js@2.11.2/denonext/realtime-js.mjs";var te=(a,e,t)=>new f(a,e,t);export{le as FunctionRegion,ue as FunctionsError,ce as FunctionsFetchError,ae as FunctionsHttpError,he as FunctionsRelayError,re as PostgrestError,f as SupabaseClient,te as createClient};
//# sourceMappingURL=supabase-js.mjs.map
// denoCacheMetadata={"headers":{"last-modified":"Sat, 29 Mar 2025 14:57:45 GMT","cache-control":"public, max-age=31536000, immutable","date":"Mon, 19 May 2025 00:30:27 GMT","access-control-allow-origin":"*","server":"cloudflare","cf-ray":"941f7c5ccf6696a6-KIX","age":"208859","vary":"Accept-Encoding","cf-cache-status":"HIT","alt-svc":"h3=\":443\"; ma=86400","content-type":"application/javascript; charset=utf-8"},"url":"https://esm.sh/@supabase/supabase-js@2.49.4/denonext/supabase-js.mjs","time":1747614627}